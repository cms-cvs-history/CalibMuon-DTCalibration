process PROD = {

	#Mapping
	es_source mapping = PoolDBESSource { VPSet toGet = {
                                      {string record = "DTReadOutMappingRcd" 
                                       string tag = "mb_map"}
                                     }
		    		     bool loadAll = true
				     string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/commissioning/wheel2/mb3_10.db"
				     untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/commissioning/wheel2/mb3Catalog.xml"
			             string timetype = "runnumber" 
				     untracked uint32 authenticationMethod = 0
				     untracked uint32 messagelevel = 0
				   }

	# Event Formatter
	source = DaqSource{ string reader = "DTROS8FileReader"
	   	untracked int32 maxEvents = 30000
			PSet pset = {  string fileName ="/afs/cern.ch/cms/Physics/muon/CMSSW/DT/data/mb3_c12_3089" } 
	}
	
	# Data Unpacker
	module dtunpacker = DTUnpackingModule{ 
		string dataType = "ROS8" }


	
	include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
	include "Geometry/DTGeometry/data/dtGeometry.cfi"

	
	# TTrig from DB
	es_source ttrig = PoolDBESSource {  VPSet toGet = {
                                    {string record = "DTTtrigRcd" 
                                     string tag = "commissioning_tTrig"
                                     } }
		    		     bool loadAll = true
                                     string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/tTrig/commissioningtTrig.db"
                                     untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/tTrig/commissioningtTrigcatalog.xml"
			             string timetype = "runnumber" 
				     untracked uint32 authenticationMethod = 0		
                                     untracked uint32 messagelevel = 0
				    }


	# T0 from DB
	es_source t0 = PoolDBESSource {  VPSet toGet = {
                                    {string record = "DTT0Rcd" 
                                     string tag = "commissioning_t0"
                                     } }
		    		     bool loadAll = true
                                     string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/t0/t0_W+2+1.db"
                                     untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/t0/t0_W+2+1catalog.xml"
			             string timetype = "runnumber" 
				     untracked uint32 authenticationMethod = 0		
                                     untracked uint32 messagelevel = 0
				    }


	# Map of noisy channels from DB
	es_source noisy = PoolDBESSource {  VPSet toGet = {
                                    {string record = "DTStatusFlagRcd" 
                                     string tag = "commissioning_noise"
                                     } }
		    		     bool loadAll = true
                                     string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/badChannels/noise/noisyChannels.db"
                                     untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite_070/badChannels/noise/noisyChannelscatalog.xml"
			             string timetype = "runnumber" 
				     untracked uint32 authenticationMethod = 0		
                                     untracked uint32 messagelevel = 0
				    }




	service = PoolDBOutputService{
	  string connect = "sqlite_file:ttrig_test.db"    
          string timetype = "runnumber"    
	  untracked uint32 authenticationMethod = 0
	  untracked string catalog = "file:ttrig_test.xml"
	  VPSet toPut={{
			untracked string containerName = "DTDBObject"
          		string tag ="ttrig_test"
			}}
	}


	module ttrigcalib = DTTTrigCalibration {
		# Switch on/off the verbosity
		untracked bool debug = true
		# Label to retrieve DT digis from the event
		untracked string digiLabel = "dtunpacker"
		# Name of the ROOT file which will contain the time boxes
		untracked string rootFileName = "DTTimeBoxes.root"
		# Switch on/off the subtraction of t0 from pulses
		untracked bool doSubtractT0 = true
		# Switch for the check of noisy channels
		untracked bool checkNoisyChannels = true
		# Module for t0 subtraction
		untracked string tTrigMode = 'DTTTrigSyncT0Only'
		# Parameter set for t0 subtraction module
		untracked PSet tTrigModeConfig = {
			untracked bool debug = true
		}
	}	
	


  
	path p = {dtunpacker, ttrigcalib}

}

