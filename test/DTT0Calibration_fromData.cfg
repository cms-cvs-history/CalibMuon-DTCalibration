process MONITOR = {    

    include "CondCore/DBCommon/data/CondDBSetup.cfi"
    include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/DTGeometry/data/dtGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

    include "VisFramework/VisApplication/data/iguana-dt.cfi"

    source = DaqSource{ 
        untracked string readerPluginName = "DTDDUFileReader"
        untracked PSet readerPset = {
	    untracked string fileName ="/tmp/sbologne/DT_W1S1S2S12_TP_vmepcs2g18-16_r34743.i0"
	    untracked bool isRaw = true
	    untracked int32 numberOfHeaderWords = 10
        }
    }

   untracked PSet maxEvents = {untracked int32 input = 70000}

    #unpacker
    module dtunpacker = DTUnpackingModule {
    string dataType = "DDU"
    untracked bool fedbyType = true
    untracked bool useStandardFEDid = true
    PSet readOutParameters  = {
	untracked bool localDAQ = true
	untracked bool performDataIntegrityMonitor = false
	untracked bool debug = false
	PSet rosParameters = {
	    untracked bool localDAQ = true
	    untracked bool readingDDU = true  
	    untracked bool writeSC = true
	    untracked bool readDDUIDfromDDU = true
	    untracked bool performDataIntegrityMonitor = false
	    untracked bool debug = false
	    }
	}
    }   

   #mapping
    es_source roMapping = PoolDBESSource {
       using CondDBSetup
	string connect =  "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB1/channelsMap_new/mapWh1.db"
	string timetype = "runnumber"
	untracked uint32 authenticationMethod = 0
	VPSet toGet = {{
		string record = "DTReadOutMappingRcd"
		string tag = "channelsMap"
	    }}
    }

   #Service to write in the DB
    service = PoolDBOutputService{
	string connect = "sqlite_file:t0.db"    	
	string timetype = "runnumber"    
	untracked uint32 authenticationMethod = 0
	PSet DBParameters = {}
	VPSet toPut={{
		string record = "DTT0Rcd"
		string tag ="t0"
	    }}
    }

     #Module to calibrate ttrig
    module t0calib = DTT0Calibration{
	# Switch on/off the verbosity
	untracked bool debug = false
	# Label to retrieve DT digis from the event
	untracked string digiLabel = "dtunpacker"
	# Chose the wheel, sector (default = All)
	untracked string calibWheel = "All"
	untracked string calibSector = "All"
	# Name of the ROOT file which will contain the test pulse times per layer
	untracked string rootFileName = "DTTestPulses.root"
	# Cells for which you want the histos (default = None)
	untracked vstring cellsWithHisto = {"-1 8 1 1 3 48","-1 8 1 1 3 49",
	                                    "-1 8 1 1 2 49","-1 8 1 1 2 50",
                                            "-1 8 1 1 1 48","-1 8 1 1 1 49"}
	# Number of events to be used for the t0 per layer histos
	uint32 eventsForLayerT0 = 2000
	# Number of events to be used for the t0 per layer histos
        uint32 eventsForWireT0 = 5000
        # Acceptance for TP peak width
        double tpPeakWidth = 5
    }	
    
    path p = {dtunpacker, t0calib}
}
