process PROD = {

    include "CondCore/DBCommon/data/CondDBSetup.cfi"
    include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/DTGeometry/data/dtGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

    source = DaqSource{ 
        untracked string readerPluginName = "DTDDUFileReader"
        untracked PSet readerPset = {
             untracked string fileName ="/tmp/giorgia/DT_W1S02S03_Noise_20mV_frlpcS1D12-18_r15225.i0"
             untracked bool isRaw = true
             untracked int32 numberOfHeaderWords = 10
        }
    }

    untracked PSet maxEvents = {untracked int32 input = 5000}

    #unpacker
    module dtunpacker = DTUnpackingModule{
       string dataType = "DDU"	
       untracked bool fedbyType = true
       untracked bool useStandardFEDid = true
       PSet readOutParameters  = {
        untracked bool localDAQ = true
        untracked bool performDataIntegrityMonitor = false
        untracked bool debug = false
        PSet rosParameters = {
            untracked bool localDAQ = true
            untracked bool readingDDU = true
            untracked bool writeSC = true
            untracked bool readDDUIDfromDDU = true
            untracked bool performDataIntegrityMonitor = false
            untracked bool debug = false
            }
        }
    }


    include "FWCore/MessageService/data/MessageLogger.cfi"


    #mapping
    es_source roMapping = PoolDBESSource {
    using CondDBSetup
    string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB1/channelsMap_new/mapWh1.db"
    string timetype = "runnumber"
    untracked uint32 authenticationMethod = 0
    VPSet toGet = {{
            string record = "DTReadOutMappingRcd"
            string tag = "channelsMap"
        }}
    }


    #tTrig
    es_source tTrigMapping = PoolDBESSource {
    using CondDBSetup
    string connect =  "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB1/tTrig/tTrig_Wh1.db"
    untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB1/tTrig/tTrig_Wh1.xml"
    string timetype = "runnumber"
    untracked uint32 authenticationMethod = 0
    VPSet toGet = {{
            string record = "DTTtrigRcd"
            string tag = "tTrig"
        }}
    }



    #module to make the plots for noise studies
    module noiseCalib = DTNoiseCalibration {
       # Switch on/off the verbosity
       untracked bool debug = true
       #Name of the ROOT file which will contains the 
       untracked string rootFileName = "DTNoiseCalib.root"
       #Total number of events
       untracked int32 TotEvents = 5000
       #The trigger width(ns)
       untracked int32 TriggerWidth = 25350
       #Trigger mode
       untracked bool cosmicRun = false
       #Database option
       untracked bool readDB = false
    }



    #module to compute noise from the plots done by DTNoiseCalibration
    module noiseComp = DTNoiseComputation {
       # Switch on/off the verbosity
       untracked bool debug = true
       #Total number of events		
       untracked int32 MaxEvents = 5000
       #Name of the ROOT file which contains the time boxes
       untracked string rootFileName = "DTNoiseCalib.root"
       #Name of the ROOT file which will contains the
       untracked string newRootFileName = "DTNoiseComp.root"
    }

    path p = {dtunpacker,noiseCalib}

}
